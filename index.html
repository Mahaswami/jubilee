<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Jubilee by isaiah</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Jubilee</h1>
        <p>A rack server with built upon Vertx</p>
        <p class="view"><a href="https://github.com/isaiah/jubilee">View the Project on GitHub <small>isaiah/jubilee</small></a></p>
        <ul>
          <li><a href="https://github.com/isaiah/jubilee/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/isaiah/jubilee/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/isaiah/jubilee">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p><a href="https://travis-ci.org/isaiah/jubilee"><img src="https://travis-ci.org/isaiah/jubilee.png?branch=master" alt="Build Status"></a></p>

<h1>
<a name="mod-rack" class="anchor" href="#mod-rack"><span class="octicon octicon-link"></span></a>mod-rack</h1>

<blockquote>
<p>A vertx module that run rack applications.</p>
</blockquote>

<h2>
<a name="get-started" class="anchor" href="#get-started"><span class="octicon octicon-link"></span></a>Get started</h2>

<p>Please checkout the <a href="https://github.com/isaiah/jubilee/wiki/Running-as-vertx-module">wiki
page</a>
before you proceed.</p>

<p>Add the following snippet to <code>$VERTX\_HOME/conf/langs.properties</code></p>

<pre><code>rackup=isaiah~mod-rack~0.1.1:org.jruby.jubilee.JubileeVerticleFactory
.ru=rackup
</code></pre>

<p>Make sure JRUBY_HOME is correctly set, and <code>rack</code> gem is install before proceed.</p>

<p>Then run the rackup file as a normal verticle,</p>

<pre lang="shell"><code>vertx run config.ru
</code></pre>

<h2>
<a name="build-from-source" class="anchor" href="#build-from-source"><span class="octicon octicon-link"></span></a>Build from source</h2>

<p>Checkout the source and run the following command in the root directory of the
project:</p>

<pre lang="shell"><code>mvn install
</code></pre>

<h1>
<a name="event-bus" class="anchor" href="#event-bus"><span class="octicon octicon-link"></span></a>Event Bus</h1>

<p>Event Bus is a pub/sub mechanism, it can be used from server to server, server
to client and client to client, with the same API! You can use it to build
living real time web application.</p>

<h2>
<a name="examples" class="anchor" href="#examples"><span class="octicon octicon-link"></span></a>Examples</h2>

<p>Assume necessary javascript files are loaded in the page (they can be found <a href="https://github.com/isaiah/jubilee/tree/master/examples/client">here</a>),
run rack application with the following config:</p>

<pre><code>$ cat config.json
{ "host": "0.0.0.0",
  "port": 8080,
  "event_bus": "/eventbus"
}
</code></pre>

<pre><code>$ vertx run config.ru -conf config.json
</code></pre>

<p>In one browser:</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">eb</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">vertx</span><span class="p">.</span><span class="nx">EventBus</span><span class="p">(</span><span class="s2">"/eventbus"</span><span class="p">);</span>
<span class="nx">eb</span><span class="p">.</span><span class="nx">registerHandler</span><span class="p">(</span><span class="s2">"test"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>

</pre></div>

<p>In another:</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">eb</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">vertx</span><span class="p">.</span><span class="nx">EventBus</span><span class="p">(</span><span class="s2">"/eventbus"</span><span class="p">);</span>
<span class="nx">eb</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s2">"test"</span><span class="p">,</span> <span class="s2">"hello, world"</span><span class="p">);</span>
</pre></div>

<p>In the previous tab it should print the greetings you just sent.</p>

<p>For more advanced examples, please checkout the
<a href="https://github.com/isaiah/jubilee/tree/master/examples/chatapp">chatapp</a>.</p>

<h2>
<a name="performance-tuning" class="anchor" href="#performance-tuning"><span class="octicon octicon-link"></span></a>Performance Tuning</h2>

<p>If you're creating a lot of connections to a Jubilee(Vert.x) server in a short
period of time, e.g. benchmarking with tools like <a href="https://github.com/wg/wrk">wrk</a>,
you may need to tweak some settings in order to avoid the TCP accept queue
getting full. This can result in connections being refused or packets being
dropped during the handshake which can then cause the client to retry.</p>

<p>A classic symptom of this is if you see long connection times just over
3000ms at your client.</p>

<p>How to tune this is operating system specific but in Linux you need to
increase a couple of settings in the TCP / Net config (10000 is an
arbitrarily large number)</p>

<pre lang="shell"><code>sudo sysctl -w net.core.somaxconn=10000
sudo sysctl -w net.ipv4.tcp_max_syn_backlog=10000
</code></pre>

<p>For other operating systems, please consult your operating system
documentation.</p>

<h2>
<a name="contributing" class="anchor" href="#contributing"><span class="octicon octicon-link"></span></a>Contributing</h2>

<p>All kinds of contributions are welcome.</p>

<p>File an issue <a href="https://github.com/isaiah/jubilee/issues">here</a> if you encounter any problems. Or if you prefer to fix by yourself:</p>

<ol>
<li>Fork it</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create new Pull Request</li>
</ol><h2>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h2>

<p>See <a href="https://github.com/isaiah/jubilee/blob/master/LICENSE.txt">LICENSE.txt</a></p>

<h2>
<a name="acknowledgment" class="anchor" href="#acknowledgment"><span class="octicon octicon-link"></span></a>Acknowledgment</h2>

<p>YourKit is kindly supporting Jubilee Server with its full-featured Java Profiler.
YourKit, LLC is the creator of innovative and intelligent tools for profiling
Java and .NET applications. Take a look at YourKit's leading software products:
<a href="http://www.yourkit.com/java/profiler/index.jsp">YourKit Java
Profiler</a> and
<a href="http://www.yourkit.com/.net/profiler/index.jsp">YourKit .NET Profiler</a>.</p>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/isaiah">isaiah</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-46822013-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>